{"ast":null,"code":"import { LOGOUT, SIGN_UP, SIGNUP_DONE, SIGNUP_ERROR, LOGIN, LOGIN_ERROR, LOGIN_DONE, SET_TOKEN, REMOVE_LOGINSUCCESS, REMOVE_SIGNSUCCESS } from '../actions/Actiontypes.js';\nimport jwt_decode from \"jwt-decode\";\nconst initialState = {\n  loading: false,\n  signupErrors: [],\n  signsuccess: '',\n  loginError: [],\n  loginsuccess: '',\n  token: '',\n  user: ''\n};\n\nconst verifytoken = token => {\n  const decodedtoken = jwt_decode(token); // console.log(\"user is\",decodedtoken);\n\n  const expires = new Date(decodedtoken.exp * 1000);\n\n  if (new Date() > expires) {\n    localStorage.removeItem('mytoken');\n    return null;\n  } else {\n    return decodedtoken;\n  }\n};\n\nconst token = localStorage.getItem('mytoken');\n\nif (token) {\n  const decoded = verifytoken(token);\n\n  if (decoded) {\n    initialState.token = token;\n    const {\n      user\n    } = decoded; //console.log(\"here is decoded user\",user[0].uname);\n\n    initialState.user = user;\n  }\n}\n\nconst AuthReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SIGN_UP:\n      return { ...state,\n        loading: true\n      };\n\n    case SIGNUP_DONE:\n      return { ...state,\n        loading: false,\n        signupErrors: [],\n        signsuccess: action.payload\n      };\n\n    case SIGNUP_ERROR:\n      return { ...state,\n        loading: false,\n        signupErrors: action.payload,\n        signsuccess: ''\n      };\n\n    case LOGIN:\n      return { ...state,\n        loading: true\n      };\n\n    case LOGIN_DONE:\n      return { ...state,\n        loading: false,\n        loginError: [],\n        loginsuccess: action.payload\n      };\n\n    case LOGIN_ERROR:\n      return { ...state,\n        loading: false,\n        loginError: action.payload,\n        loginsuccess: ''\n      };\n\n    case SET_TOKEN:\n      const decoded = verifytoken(action.payload);\n      const {\n        user\n      } = decoded;\n      console.log('userrr', user);\n      return { ...state,\n        token: action.payload,\n        user: user\n      };\n\n    case LOGOUT:\n      return { ...state,\n        token: '',\n        user: '',\n        signsuccess: '',\n        loginsuccess: ''\n      };\n\n    case REMOVE_LOGINSUCCESS:\n      return { ...state,\n        loginsuccess: ''\n      };\n\n    case REMOVE_LOGINSUCCESS:\n      return { ...state,\n        loginsuccess: ''\n      };\n\n    default:\n      return state;\n  }\n};\n\n_c = AuthReducer;\nexport default AuthReducer;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthReducer\");","map":{"version":3,"sources":["D:/data1/MERNblog/frontend/src/redux/reducers/AuthReducer.js"],"names":["LOGOUT","SIGN_UP","SIGNUP_DONE","SIGNUP_ERROR","LOGIN","LOGIN_ERROR","LOGIN_DONE","SET_TOKEN","REMOVE_LOGINSUCCESS","REMOVE_SIGNSUCCESS","jwt_decode","initialState","loading","signupErrors","signsuccess","loginError","loginsuccess","token","user","verifytoken","decodedtoken","expires","Date","exp","localStorage","removeItem","getItem","decoded","AuthReducer","state","action","type","payload","console","log"],"mappings":"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","sourcesContent":["import {LOGOUT,SIGN_UP,SIGNUP_DONE,SIGNUP_ERROR,LOGIN,LOGIN_ERROR,LOGIN_DONE,SET_TOKEN,REMOVE_LOGINSUCCESS,REMOVE_SIGNSUCCESS} from '../actions/Actiontypes.js';\r\n\r\nimport jwt_decode from \"jwt-decode\";\r\nconst initialState={\r\n    loading: false,\r\n    signupErrors:[],\r\n    signsuccess:'',\r\n    loginError:[],\r\n    loginsuccess:'',\r\n    token:'',\r\n    user:''\r\n}\r\nconst verifytoken=token=>{\r\n    const decodedtoken=jwt_decode(token);\r\n   // console.log(\"user is\",decodedtoken);\r\n    const expires=new Date(decodedtoken.exp*1000);\r\n    if(new Date()> expires)\r\n    {\r\n    localStorage.removeItem('mytoken');\r\n    return null;\r\n\r\n    }\r\n    else\r\n    {\r\n        return decodedtoken;\r\n    }\r\n}\r\nconst token=localStorage.getItem('mytoken');\r\nif(token)\r\n{\r\n    const decoded=verifytoken(token);\r\n    if(decoded)\r\n    {\r\n        initialState.token=token;\r\n        const {user}=decoded;\r\n        //console.log(\"here is decoded user\",user[0].uname);\r\n        initialState.user=user;\r\n    }\r\n  \r\n\r\n}\r\n\r\n\r\n\r\nconst AuthReducer=(state=initialState,action)=>{\r\n   switch(action.type)\r\n   {\r\n       case SIGN_UP:return{\r\n           ...state,\r\n           loading:true\r\n       }\r\n       case SIGNUP_DONE:return{\r\n           ...state,\r\n           loading:false,\r\n           signupErrors:[],\r\n           signsuccess:action.payload\r\n       }\r\n       case SIGNUP_ERROR:return{\r\n           ...state,\r\n           loading:false,\r\n           signupErrors:action.payload,\r\n           signsuccess:''\r\n       }\r\n       case LOGIN:return{\r\n        ...state,\r\n        loading:true\r\n\r\n       }\r\n       case LOGIN_DONE:return{\r\n        ...state,\r\n        loading:false,\r\n        loginError:[],\r\n        loginsuccess:action.payload\r\n\r\n       }\r\n       case LOGIN_ERROR:return{ \r\n           ...state,\r\n        loading:false,\r\n        loginError:action.payload,\r\n        loginsuccess:''\r\n    }\r\n    case SET_TOKEN:\r\n        const decoded=verifytoken(action.payload);\r\n        const {user} =decoded;\r\n        console.log('userrr',user);\r\n        return{\r\n            ...state,\r\n            token:action.payload,\r\n            user:user\r\n        }\r\n     case LOGOUT:return{\r\n            ...state,\r\n            token:'',\r\n            user:'',\r\n            signsuccess:'',\r\n            loginsuccess:''\r\n\r\n        }\r\n        case REMOVE_LOGINSUCCESS:return{\r\n            ...state,\r\n            loginsuccess:'',\r\n            \r\n        }\r\n        case REMOVE_LOGINSUCCESS:return{\r\n            ...state,\r\n            loginsuccess:'',\r\n            \r\n        }\r\n       default: return state;\r\n   }\r\n  \r\n}\r\nexport default AuthReducer;"]},"metadata":{},"sourceType":"module"}